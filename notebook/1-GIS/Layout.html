

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Description of the propagation environment &mdash; PyLayers</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Modifying the segment nature" href="Multisubsegments.html" />
    <link rel="prev" title="1 Overview" href="../TOC.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Python
          

          
            
            <img src="../../_static/pylayers.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../TOC.html"><span class="sectnum">1</span> Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#basic-usage"><span class="sectnum">2</span> Basic Usage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../TOC.html#environment-description"><span class="sectnum">3</span> Environment Description</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Description of the propagation environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#getting-the-list-of-all-available-layouts-the-ls-method">Getting the list of all available Layouts : the <code class="docutils literal notranslate"><span class="pre">ls()</span></code> method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#structure-of-the-lay-file">Structure of the <code class="docutils literal notranslate"><span class="pre">.lay</span></code> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#layout-vizualisation">Layout vizualisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#layout-bounding-box">Layout bounding box</a></li>
<li class="toctree-l4"><a class="reference internal" href="#layout-graphs-build">Layout graphs build</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-more-realistic-example">A more realistic example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-useful-numpy-arrays-of-the-layout">The useful numpy arrays of the Layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tgs-trancodage-from-graph-indexing-to-numpy-array-indexing"><code class="docutils literal notranslate"><span class="pre">tgs</span></code> : trancodage from graph indexing to numpy array indexing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Multisubsegments.html">Modifying the segment nature</a></li>
<li class="toctree-l3"><a class="reference internal" href="Ezone.html">Geographical Information and the Earth Zone class : <code class="docutils literal notranslate"><span class="pre">Ezone</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="Coverage.html">Outdoor Coverage Knife-Edge Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#materials-and-slabs"><span class="sectnum">4</span> Materials and Slabs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#description-of-antennas"><span class="sectnum">5</span> Description of Antennas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#coverage-simulation"><span class="sectnum">6</span> Coverage Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#ray-tracing-simulation"><span class="sectnum">7</span> Ray Tracing Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#handling-agent-mobility"><span class="sectnum">8</span> Handling Agent Mobility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#other-simulation-examples"><span class="sectnum">9</span> Other Simulation Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#localization-algorithms"><span class="sectnum">10</span> Localization Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#measurements-tools"><span class="sectnum">11</span> Measurements Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TOC.html#pylayers-tools"><span class="sectnum">12</span> PyLayers Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exLayout1.html">Loading an outdoor layout from its address</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_antenna.html">Antenna Pattern for an H plane sectoral antenna &#64; 32GHz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exLayout2.html">Building graphs of a Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_coverage.html">Indoor Radio Coverage with Motley Keenan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_layout.html">8 Random Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_issue314.html">Exemple of issue 314</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exAbsGas.html">Attenuation due to atmospheric gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exDLink.html">Evaluation of a radio link DLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_w1.html">Indoor Radio Coverage FP7 WHERE1 M1 setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_exLuebbers.html">UWB Ray tracing simulation  in outdoor scenario</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_dakar.html">Outdoor Radio Coverage with Deygout Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_cover.html">Outdoor Radio Coverage with Deygout Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_diffraction_polar.html">Diffraction coefficient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/plot_diffraction.html">Diffraction coefficient</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Manual</a> &raquo;</li>
        
          <li><a href="../TOC.html"><span class="sectnum">1</span> Overview</a> &raquo;</li>
        
      <li>Description of the propagation environment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/notebook/1-GIS/Layout.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>date
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vendredi 1 fvrier 2019, 08:21:12 (UTC+0100)
</pre></div>
</div>
<div class="section" id="description-of-the-propagation-environment">
<h1>Description of the propagation environment<a class="headerlink" href="#description-of-the-propagation-environment" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">Layout</span></code> class contains the data structure for describing a
propagation environment. It contains different graphs helping the
implementation of the ray tracing. The class is implemented in the
module
<a class="reference external" href="http://pylayers.github.io/pylayers/api/pylayers.gis.layout.Layout.html">layout.py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pylayers.gis.layout</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<div class="section" id="getting-the-list-of-all-available-layouts-the-ls-method">
<h2>Getting the list of all available Layouts : the <code class="docutils literal notranslate"><span class="pre">ls()</span></code> method<a class="headerlink" href="#getting-the-list-of-all-available-layouts-the-ls-method" title="Permalink to this headline">¶</a></h2>
<p>Creating an empty Layout is as simple as :</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="n">Layout</span><span class="p">()</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>----------------
Project : /home/uguen/Bureau/P1

newfile.lay
Type : outdoor
Coordinates : cart
----------------
Gs : 0(0/0/0) :0
Gt : 0 : 0
Gr : 0 : 0
----------------


xrange : (-50, 50)
yrange : (-50, 50)
</pre></div>
</div>
<p>The different argument of the <strong>init</strong> function are listed below</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">mat</span><span class="o">=</span><span class="s1">&#39;matDB.ini&#39;</span><span class="p">,</span>
                 <span class="n">slab</span><span class="o">=</span><span class="s1">&#39;slabDB.ini&#39;</span><span class="p">,</span>
                 <span class="n">fur</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">bcheck</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">bbuild</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">bverbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">bcartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">xlim</span><span class="o">=</span><span class="p">(),</span>
                 <span class="n">dist_m</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
                 <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;indoor&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>string</strong> is either an existing layout filename (.lay,.osm,.res) or
the coordinates (lat,lon)</p></li>
<li><p><strong>mat</strong> is the a material filename material ans slab are now
described in .lay file</p></li>
<li><p><strong>slab</strong> is the a slab filename</p></li>
<li><p><strong>fur</strong> is the furniture filename</p></li>
<li><p><strong>bcheck</strong> is a boolean which force layout integrity checking</p></li>
<li><p><strong>bbuild</strong> is a boolean which force rebuilding the layouts graphs</p></li>
<li><p><strong>bverbose</strong> is a boolean output verbosity</p></li>
<li><p><strong>bcartesian</strong> is a boolean controling the type of coordinates
cartesian or (lat,lon)</p></li>
<li><p><strong>xlim</strong> is a tuple with specifies the layout limits</p></li>
<li><p><strong>dist_m</strong> is a float value which indicates the zone radius in meters
for openstreet map extraction</p></li>
<li><p><strong>typ</strong> is a string which takes values either indoor or outdoor</p></li>
</ul>
<p>Querying the file name associated with the Layout.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">_filename</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;newfile.lay&#39;
</pre></div>
</div>
<p>The Layout is described in an <code class="docutils literal notranslate"><span class="pre">.lay</span></code> file, a <code class="docutils literal notranslate"><span class="pre">.osm</span></code>file or a
<code class="docutils literal notranslate"><span class="pre">.res</span></code> file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ls()</span></code> method lists the layout files which are available in the
<code class="docutils literal notranslate"><span class="pre">struc</span></code> directory of your current project, which is set up via the
$BASENAME environment variable which should be defined in order to seek
layout file in the good project directory.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="s1">&#39;lay&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;11Dbibli.lay&#39;,
 &#39;48.0894444444_,_-1.67388888889.lay&#39;,
 &#39;B11.lay&#39;,
 &#39;B11_.lay&#39;,
 &#39;CEA.lay&#39;,
 &#39;CEA2.lay&#39;,
 &#39;CEA2_.lay&#39;,
 &#39;CORM1.lay&#39;,
 &#39;Campus_de_Beaulieu_Rennes.lay&#39;,
 &#39;DLR.lay&#39;,
 &#39;DLR2.lay&#39;,
 &#39;Luebbers.lay&#39;,
 &#39;Luebbers_v12.lay&#39;,
 &#39;MOCAP-small.lay&#39;,
 &#39;MOCAP-small2.lay&#39;,
 &#39;MOCAP.lay&#39;,
 &#39;MOCAPext.lay&#39;,
 &#39;Munich.lay&#39;,
 &#39;Munich_buildings.lay&#39;,
 &#39;Rennes.lay&#39;,
 &#39;Saint_Malo.lay&#39;,
 &#39;Scene.lay&#39;,
 &#39;Servon_SUr_Vilaine.lay&#39;,
 &#39;Servon_sur_Vilaine.lay&#39;,
 &#39;TA-Office.lay&#39;,
 &#39;TA-Office3.lay&#39;,
 &#39;TC1_METIS.lay&#39;,
 &#39;TC1_METIS_2D.lay&#39;,
 &#39;TC1_METIS_2D2.lay&#39;,
 &#39;TC2_METIS.lay&#39;,
 &#39;W2PTIN.lay&#39;,
 &#39;WHERE1.lay&#39;,
 &#39;calcul1.lay&#39;,
 &#39;calcul2.lay&#39;,
 &#39;defdiff.lay&#39;,
 &#39;defsthdiff.lay&#39;,
 &#39;defstr.lay&#39;,
 &#39;defstr.str.lay&#39;,
 &#39;edge.lay&#39;,
 &#39;espoo.lay&#39;,
 &#39;espoo2.lay&#39;,
 &#39;espoo3.lay&#39;,
 &#39;espoo4.lay&#39;,
 &#39;espoo_keskus_fi.lay&#39;,
 &#39;homeK_vf.lay&#39;,
 &#39;klepal.lay&#39;,
 &#39;klepal_.lay&#39;,
 &#39;klepal__.lay&#39;,
 &#39;lat_-1_4608251_lon_48_1218969.lay&#39;,
 &#39;lat_12_0065911_lon_57_6954186.lay&#39;,
 &#39;lat_48_1033333_lon_-1_61833.lay&#39;,
 &#39;lat_48_873679_lon_2_293128.lay&#39;,
 &#39;lat_57_696495_lon_12_006234.lay&#39;,
 &#39;library_I2_final.lay&#39;,
 &#39;office_I1.lay&#39;,
 &#39;office_I1_aki_4m.lay&#39;,
 &#39;office_I1_final.lay&#39;,
 &#39;otakaari5A.lay&#39;,
 &#39;otakari.lay&#39;,
 &#39;otakari_.lay&#39;,
 &#39;scattering.lay&#39;,
 &#39;stromberg15GHz.lay&#39;,
 &#39;stromberg28GHz.lay&#39;,
 &#39;stromberg83GHz.lay&#39;,
 &#39;test.lay&#39;,
 &#39;test_face.lay&#39;,
 &#39;testair0.lay&#39;,
 &#39;testair1.lay&#39;]
</pre></div>
</div>
<p>A very simple Layout which is used for testing is <code class="docutils literal notranslate"><span class="pre">defstr.lay</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="s1">&#39;defstr.lay&#39;</span><span class="p">)</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>----------------
Project : /home/uguen/Bureau/P1

defstr.lay : c9527fce60fe26328f7bacc7da6899ee
Type : indoor
Coordinates : cart
----------------
Gs : 27(12/15/3) :30
Gt : 0 : 0
Gr : 0 : 0
----------------

degree 0 : [-12 -10  -9 -11]
degree 1 : []
number of node points of degree 2 : 4
number of node points of degree 3 : 4

xrange : (-1.5, 11.5)
yrange : (-1.5, 6.5)
center : ( 5.00,2.67)
radius : 7.72
</pre></div>
</div>
</div>
<div class="section" id="structure-of-the-lay-file">
<h2>Structure of the <code class="docutils literal notranslate"><span class="pre">.lay</span></code> file<a class="headerlink" href="#structure-of-the-lay-file" title="Permalink to this headline">¶</a></h2>
<p>The description file of a Layout has the extension <code class="docutils literal notranslate"><span class="pre">.lay</span></code> it is an
<code class="docutils literal notranslate"><span class="pre">ini</span></code> file which contains the following section.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[info]
format= {cart | latlon}
version = 1.3
type = {indoor | outdoor}

[points]
-1 = (0.0,0.0)
...

[segments]
1 = {&#39;name&#39;: ,&#39;connect&#39;: ,&#39;z&#39;:}
...

[slabs]
WALL = {&#39;color: ,&#39;linewidth&#39;: ,&#39;lthick&#39;:[] ,&#39;lmatname&#39;:[]}

[materials]
WOOD = {&#39;mur&#39;:,&#39;epr&#39;:,&#39;sigma&#39;:,&#39;roughness&#39;:}

[indoor] ;if type==&#39;indoor&#39;
zceil = 3
zfloor = 0
</pre></div>
</div>
</div>
<div class="section" id="layout-vizualisation">
<h2>Layout vizualisation<a class="headerlink" href="#layout-vizualisation" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">showG</span></code> method is for showing the layout in specifying which graph
entities to display.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span>
             <span class="n">nodes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">slab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">subseg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
         <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Layout_16_0.png" src="../../_images/Layout_16_0.png" />
</div>
<div class="section" id="layout-bounding-box">
<h2>Layout bounding box<a class="headerlink" href="#layout-bounding-box" title="Permalink to this headline">¶</a></h2>
<p>L.ax provides the boundary of the layout with the following tuple format
: (xmin,xmax,ymin,ymax)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">ax</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(-1.5, 11.5, -1.5, 6.5)
</pre></div>
</div>
</div>
<div class="section" id="layout-graphs-build">
<h2>Layout graphs build<a class="headerlink" href="#layout-graphs-build" title="Permalink to this headline">¶</a></h2>
<p>A Layout has to be associated with a set of graphs which are built from
the initial description in <code class="docutils literal notranslate"><span class="pre">L.Gs</span></code>. Those graphs are stored in pickle
files in a gpickle <code class="docutils literal notranslate"><span class="pre">$BASENAME/struc/gpickle</span></code> directory.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Gv</span><span class="o">.</span><span class="n">node</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NodeView((1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 17, 30, 22, -6, 27, -4, -3, -1))
</pre></div>
</div>
<p>A Layout is decomposed into convex cycles which are stored in the Gt
graph. The diffraction points are stored in the dictionnary <code class="docutils literal notranslate"><span class="pre">L.ddiff</span></code>.
The keys of this dictionnary are the diffraction points number and the
values are a zipped list of output cycles and corresponding wedge
angles.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">ddiff</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{-6: ([4, 1], 4.7123889803846897),
 -4: ([6, 4], 4.7123889803846897),
 -3: ([6, 3], 4.7123889803846897),
 -1: ([3, 1], 4.7123889803846897)}
</pre></div>
</div>
<p>i.e -6: ([4, 1], 4.712) means Diffracting node -6 which diffract toward
the exterior sector: cycles 4 and 1 with a wedge angle of 270 degrees.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Gt</span><span class="o">.</span><span class="n">node</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NodeView((0, 1, 2, 3, 4, 5, 6))
</pre></div>
</div>
</div>
<div class="section" id="a-more-realistic-example">
<h2>A more realistic example<a class="headerlink" href="#a-more-realistic-example" title="Permalink to this headline">¶</a></h2>
<p>Let load the DLR building</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="s1">&#39;DLR.lay&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">aw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Layout_27_0.png" src="../../_images/Layout_27_0.png" />
<p>To check which are the used slabs :</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">sl</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>List of Slabs
-----------------------------

PARTITION : |PLASTER
[0.1]
       grey80 4
       epr :(8+0j)    sigma : 0.038
CEIL : |REINFORCED_CONCRETE
[0.1]
       grey20 1
       epr :(8.69999980927+0j)    sigma : 3.0
_AIR : |AIR
[0.02]
       white 1
       epr :(1+0j)    sigma : 0.0
WALL : |BRICK
[0.07]
       grey20 3
       epr :(4.09999990463+0j)    sigma : 0.300000011921
AIR : |AIR
[0.02]
       white 1
       epr :(1+0j)    sigma : 0.0
3D_WINDOW_GLASS : |GLASS|AIR|GLASS
[0.005, 0.005, 0.005]
       blue3 1
       epr :(3.79999995232+0j)    sigma : 0.0
       epr :(1+0j)    sigma : 0.0
       epr :(3.79999995232+0j)    sigma : 0.0
FLOOR : |REINFORCED_CONCRETE
[0.1]
       grey40 1
       epr :(8.69999980927+0j)    sigma : 3.0
</pre></div>
</div>
<p>Lets load an other layout. This an indoor office where the FP7 WHERE
project UWB impulse radio measuremnts have been performed.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="s1">&#39;WHERE1.lay&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The showG method provides many possible visualization of the layout</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">airwalls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../../_images/Layout_33_0.png" src="../../_images/Layout_33_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="s1">&#39;W2PTIN.lay&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Layout_35_0.png" src="../../_images/Layout_35_0.png" />
</div>
<div class="section" id="the-useful-numpy-arrays-of-the-layout">
<h2>The useful numpy arrays of the Layout<a class="headerlink" href="#the-useful-numpy-arrays-of-the-layout" title="Permalink to this headline">¶</a></h2>
<p>The layout data structure is a mix between graph and numpy array. numpy
arrays are used when high performance is required while graph structure
is convenient when dealing with different specific tasks. The tricky
thing for the mind is to have to transcode between node index excluding
0 and numpy array index including 0. Below are listed various useful
numpy array which are mostly used internally.</p>
<ul class="simple">
<li><p>tsg : get segment index in Gs from tahe</p></li>
<li><p>isss : sub-segment index above Nsmax</p></li>
<li><p>tgs : get segment index in tahe from Gs</p></li>
<li><p>lsss : list of segments with sub-segment</p></li>
<li><p>sla : list of all slab names (Nsmax+Nss+1)</p></li>
<li><p>degree : degree of nodes</p></li>
</ul>
<div class="section" id="pt-the-array-of-points">
<h3><code class="docutils literal notranslate"><span class="pre">pt</span></code> the array of points<a class="headerlink" href="#pt-the-array-of-points" title="Permalink to this headline">¶</a></h3>
<p>The point coordinates are stored in two different places</p>
<ul class="simple">
<li><p>L.Gs.pos : in a dictionary form (key is the point negative index)</p></li>
<li><p>L.pt : in a numpy array</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">pt</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">([</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">Gs</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(2, 185)
185
</pre></div>
</div>
<p>This dual storage is chosen for computational efficiency reason. The
priority goes to the graph and the numpy array is calculated at the end
of the edition in the <code class="docutils literal notranslate"><span class="pre">Layout.g2npy</span></code> method (graph to numpy) which
handle the conversion.</p>
</div>
<div class="section" id="tahe-tail-head">
<h3>tahe (tail-head)<a class="headerlink" href="#tahe-tail-head" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">tahe</span></code> is a <span class="math notranslate nohighlight">\((2\times N_{s})\)</span> where <span class="math notranslate nohighlight">\(N_s\)</span> denotes the
number of segments. The first line is the tail index of the segment
<span class="math notranslate nohighlight">\(k\)</span> and the second line is the head of the segment <span class="math notranslate nohighlight">\(k\)</span>.
Where <span class="math notranslate nohighlight">\(k\)</span> is the index of a given segment (starting in 0).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
</pre></div>
</div>
<p>The figure below illustrates a Layout and a superimposition of the graph
of cycles <span class="math notranslate nohighlight">\(\mathcal{G}_c\)</span>. Those cycles are automatically
extracted from a well defined layout. This concept of <strong>cycles</strong> is
central in the ray determination algorithm which is implemented in
PyLayers. Notice that the exterior region is the cycle indexed by 0. All
the rooms which have a common frontier with the exterior cycle are here
connected to the origin (corresponding to exterior cycle).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Layout_41_0.png" src="../../_images/Layout_41_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lp1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">Gi</span><span class="p">,</span><span class="n">L</span><span class="o">.</span><span class="n">Gi</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span><span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">node_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">Gi</span><span class="p">,</span><span class="n">L</span><span class="o">.</span><span class="n">Gi</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span><span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">node_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Layout_42_0.png" src="../../_images/Layout_42_0.png" />
</div>
</div>
<div class="section" id="tgs-trancodage-from-graph-indexing-to-numpy-array-indexing">
<h2><code class="docutils literal notranslate"><span class="pre">tgs</span></code> : trancodage from graph indexing to numpy array indexing<a class="headerlink" href="#tgs-trancodage-from-graph-indexing-to-numpy-array-indexing" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">tgs</span></code> is an array with length <span class="math notranslate nohighlight">\(N_s\)</span>+1. The index 0 is not used
because none segment has 0 as an index.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">utahe</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">tgs</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tahe</span> <span class="o">=</span>  <span class="n">L</span><span class="o">.</span><span class="n">tahe</span><span class="p">[:,</span><span class="n">utahe</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ptail</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">pt</span><span class="p">[:,</span><span class="n">tahe</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">phead</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">pt</span><span class="p">[:,</span><span class="n">tahe</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ptail</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ 29.785   6.822]
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">phead</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ 27.414   6.822]
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">.</span><span class="n">Gs</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;connect&#39;: [-8, -139],
 &#39;iso&#39;: [326],
 &#39;name&#39;: &#39;PARTITION&#39;,
 &#39;ncycles&#39;: [70, 72],
 &#39;norm&#39;: array([ 0.,  1.,  0.]),
 &#39;offset&#39;: 0,
 &#39;transition&#39;: False,
 &#39;z&#39;: (0, 3.0)}
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">Gs</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(29.785, 6.822)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aseg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">134</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">aseg</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(3,)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span>  <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">tahe</span><span class="p">[:,</span><span class="n">L</span><span class="o">.</span><span class="n">tgs</span><span class="p">[</span><span class="n">aseg</span><span class="p">]][</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">ph</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">tahe</span><span class="p">[:,</span><span class="n">L</span><span class="o">.</span><span class="n">tgs</span><span class="p">[</span><span class="n">aseg</span><span class="p">]][</span><span class="mi">1</span><span class="p">,:]</span>
<span class="n">pth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">pt</span><span class="p">,</span><span class="n">ph</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Multisubsegments.html" class="btn btn-neutral float-right" title="Modifying the segment nature" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../TOC.html" class="btn btn-neutral float-left" title="1 Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, PyLayers developer team
      <span class="lastupdated">
        Last updated on Apr 02, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>