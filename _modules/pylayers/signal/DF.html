

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pylayers.signal.DF &mdash; PyLayers</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Python
          

          
            
            <img src="../../../_static/pylayers.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../notebook/index.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_exLayout1.html">Loading an outdoor layout from its address</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_antenna.html">Antenna Pattern for an H plane sectoral antenna &#64; 32GHz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_exLayout2.html">Building graphs of a Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_coverage.html">Indoor Radio Coverage with Motley Keenan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_layout.html">8 Random Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_issue314.html">Exemple of issue 314</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_exAbsGas.html">Attenuation due to atmospheric gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_exDLink.html">Evaluation of a radio link DLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_w1.html">Indoor Radio Coverage FP7 WHERE1 M1 setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_exLuebbers.html">UWB Ray tracing simulation  in outdoor scenario</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_dakar.html">Outdoor Radio Coverage with Deygout Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_cover.html">Outdoor Radio Coverage with Deygout Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_diffraction_polar.html">Diffraction coefficient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_examples/plot_diffraction.html">Diffraction coefficient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html">1&nbsp;&nbsp;&nbsp;pylayers.util.project Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.gis.layout">2&nbsp;&nbsp;&nbsp;pylayers.gis.layout Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.gis.selectl">3&nbsp;&nbsp;&nbsp;pylayers.gis.selectl Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.gis.srtm">4&nbsp;&nbsp;&nbsp;pylayers.gis.srtm Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.gis.osmparser">5&nbsp;&nbsp;&nbsp;pylayers.gis.osmparser Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.gis.ezone">6&nbsp;&nbsp;&nbsp;pylayers.gis.ezone Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.antenna">7&nbsp;&nbsp;&nbsp;pylayers.antprop.antenna Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.aarray">8&nbsp;&nbsp;&nbsp;pylayers.antprop.aarray Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.spharm">9&nbsp;&nbsp;&nbsp;pylayers.antprop.spharm Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.antssh">10&nbsp;&nbsp;&nbsp;pylayers.antprop.antssh Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.antvsh">11&nbsp;&nbsp;&nbsp;pylayers.antprop.antvsh Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.slab">12&nbsp;&nbsp;&nbsp;pylayers.antprop.slab Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.signature">13&nbsp;&nbsp;&nbsp;pylayers.antprop.signature Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.interactions">14&nbsp;&nbsp;&nbsp;pylayers.antprop.interactions Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.diffraction">15&nbsp;&nbsp;&nbsp;pylayers.antprop.diffraction Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.diffRT">16&nbsp;&nbsp;&nbsp;pylayers.antprop.diffRT Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.rays">17&nbsp;&nbsp;&nbsp;pylayers.antprop.rays Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.loss">18&nbsp;&nbsp;&nbsp;pylayers.antprop.loss Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.channel">19&nbsp;&nbsp;&nbsp;pylayers.antprop.channel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#id39">20&nbsp;&nbsp;&nbsp;pylayers.antprop.loss Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.coverage">21&nbsp;&nbsp;&nbsp;pylayers.antprop.coverage Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.antprop.coeffModel">22&nbsp;&nbsp;&nbsp;pylayers.antprop.coeffModel Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.simul.link">23&nbsp;&nbsp;&nbsp;pylayers.simul.link Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.simul.exploit">24&nbsp;&nbsp;&nbsp;pylayers.simul.exploit Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.simul.exploit_simulnet">25&nbsp;&nbsp;&nbsp;pylayers.simul.exploit_simulnet Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.simul.simulnet">26&nbsp;&nbsp;&nbsp;pylayers.simul.simulnet Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.simul.simultraj">27&nbsp;&nbsp;&nbsp;pylayers.simul.simultraj Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.exploit.simnet">28&nbsp;&nbsp;&nbsp;pylayers.exploit.simnet Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.measures.mesuwb">29&nbsp;&nbsp;&nbsp;pylayers.measures.mesuwb Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.measures.mesmimo">30&nbsp;&nbsp;&nbsp;pylayers.measures.mesmimo Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.measures.cormoran">31&nbsp;&nbsp;&nbsp;pylayers.measures.cormoran Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.measures.vna.E5072A">32&nbsp;&nbsp;&nbsp;pylayers.measures.vna.E5072A Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.measures.parker.smparker">33&nbsp;&nbsp;&nbsp;pylayers.measures.parker.smparker Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.signal.bsignal">34&nbsp;&nbsp;&nbsp;pylayers.signal.bsignal Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.signal.standard">35&nbsp;&nbsp;&nbsp;pylayers.signal.standard Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.signal.device">36&nbsp;&nbsp;&nbsp;pylayers.signal.device Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.signal.DF">37&nbsp;&nbsp;&nbsp;pylayers.signal.DF Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.signal.waveform">38&nbsp;&nbsp;&nbsp;pylayers.signal.waveform Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.mobility.agent">39&nbsp;&nbsp;&nbsp;pylayers.mobility.agent Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#module-pylayers.mobility.ban.body">40&nbsp;&nbsp;&nbsp;pylayers.mobility.ban.body Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/references.html#id138">41&nbsp;&nbsp;&nbsp;pylayers.measures.cormoran Module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pylayers.signal.DF</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pylayers.signal.DF</h1><div class="highlight"><pre>
<span></span>#!/usr/bin/python
#-*- coding:Utf-8 -*-
&quot;&quot;&quot;

DF Class
========

This class implements a LTI digital filter

.. currentmodule:: pylayers.signal.DF

.. autoclass:: DF
    :members:

&quot;&quot;&quot;
import numpy as np
from scipy import io
from pylayers.util.project import *
import pylayers.signal.bsignal  as bs
import scipy.signal as si
import sympy as sy
import numpy.fft as fft
import matplotlib.pyplot as plt

<div class="viewcode-block" id="DF"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF">[docs]</a>class DF(PyLayers):
    &quot;&quot;&quot; Digital Filter Class

    Attributes
    ----------

    a : array
        transfer function coefficients denominator
    b : array
        transfer function coefficients numerator
    p : array dtype=complex
        transfer function poles
    z : array dtype=complex
        transfer function zeros

    Methods
    -------

    filter : filter a signal
    freqz  : Display transfer function
    ellip_bp : elliptic bandpath filter
    remez : FIR design

    &quot;&quot;&quot;
    def __init__(self,b=np.array([1]),a=np.array([1])):
        self.b = b
        self.a = a
        #self.z = np.poly1d(self.b).r
        #self.p = np.poly1d(self.a).r
        #assert(np.abs(self.b-np.poly1d(self.z,r=True).c).all()&lt;1e-16)
        #assert(np.abs(self.a-np.poly1d(self.p,r=True).c).all()&lt;1e-16)

    @property
    def a(self):
        return(self._a)

    @property
    def b(self):
        return(self._b)

    @property
    def z(self):
        return(self._z)

    @property
    def p(self):
        return(self._p)

    @a.setter
    def a(self,a):
        self._a = a
        self._p = np.poly1d(a).r
        if len(a)==1:
            self.fir=True
        else:
            self.fir=False

    @b.setter
    def b(self,b):
        self._b = b
        self._z = np.poly1d(b).r

    @z.setter
    def z(self,z):
        self._z = z
        self._b = np.poly1d(z,r=True).c

    @p.setter
    def p(self,p):
        self._p = p
        self._a = np.poly1d(p,r=True).c

<div class="viewcode-block" id="DF.update"><a class="viewcode-back" href="../../../api/pylayers.signal.DF.DF.html#pylayers.signal.DF.DF.update">[docs]</a>    def update(self):
        self.a =  np.poly1d(self.p,r=True).c
        self.b =  np.poly1d(self.z,r=True).c</div>

    def __repr__(self):
        st = &#39;&#39;
        st = st + &#39;b : &#39;+str(self.b)+&#39;\n&#39;
        st = st + &#39;a : &#39;+str(self.a)+&#39;\n&#39;
        st = st + &#39;z : &#39;+str(self.z)+&#39;\n&#39;
        st = st + &#39;p : &#39;+str(self.p)+&#39;\n&#39;
        return(st)
    def __mul__(self,df):
        &quot;&quot;&quot;
        extract and stack  poles and zeros

        TODO : handling simplification
        &quot;&quot;&quot;

        b1 = self.b
        a1 = self.a
        b2 = df.b
        a2 = df.a

        pb1 = np.poly1d(b1)
        pa1 = np.poly1d(a1)
        pb2 = np.poly1d(b2)
        pa2 = np.poly1d(a2)

        rpb1 = pb1.r
        rpb2 = pb2.r
        rpa1 = pa1.r
        rpa2 = pa2.r

        F   = DF()
        F.p = np.hstack((rpa1,rpa2))
        F.z = np.hstack((rpb1,rpb2))

        F.simplify()

        return(F)


<div class="viewcode-block" id="DF.simplify"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.simplify">[docs]</a>    def simplify(self,tol=1e-16):
        &quot;&quot;&quot; simplify transfer function

        Parameters
        ----------
        tol : float
            tolerance for simplification

        &quot;&quot;&quot;
        ip = []
        iz = []
        for k,p in enumerate(self.p):
            for l,z in enumerate(self.z):
                md = np.real((p-z)*np.conj(p-z))
                if md&lt;tol:
                    ip.append(k)
                    iz.append(l)

        self.p = np.delete(self.p,ip)
        self.z = np.delete(self.z,iz)</div>

<div class="viewcode-block" id="DF.flipc"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.flipc">[docs]</a>    def flipc(self):
        &quot;&quot;&quot; flip coefficient

        This is equivalent to the transformation

        z -&gt; 1/z

        &quot;&quot;&quot;
        F = DF()
        F.a = self.a[::-1]
        F.b = self.b[::-1]
        F.update()
        return(F)</div>

<div class="viewcode-block" id="DF.match"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.match">[docs]</a>    def match(self):
        r&quot;&quot;&quot; return a match filter

        Returns
        -------

        DF :


        Notes
        -----

        if $$H(z)=\\frac{1+b_1z^1+...+b_Nz^{-N}}{1+a_1z^1+...+a_Mz^{-M}}$$

        it returns

        $$H_m(z)=\\frac{b_N+b_{N-1}z^1+...+z^{-N}}{1+a_1z^1+...+a_Mz^{-M}}$$

        &quot;&quot;&quot;

        if self.fir:
            MF = DF()
            MF.b = np.conj(self.b[::-1])
            MF.a = self.a
            MF.z = np.poly1d(MF.b).r
            MF.p = np.poly1d(MF.a).r
            return(MF)</div>

<div class="viewcode-block" id="DF.filter"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.filter">[docs]</a>    def filter(self,s,causal=True):
        &quot;&quot;&quot; filter s

        Parameters
        ----------

        s : np.array |TUsignal
            input signal

        Returns
        -------

        y : np.array | TUsignal
            output signal

        Examples
        --------

        .. plot::
            :include-source:

            &gt;&gt;&gt; import matplotlib.pyplot as plt
            &gt;&gt;&gt; df = DF(b=np.array([1,1],a=np.array([1,-1]))
            &gt;&gt;&gt; N = 100 
            &gt;&gt;&gt; s = np.zeros(N)
            &gt;&gt;&gt; s[0] = 1
            &gt;&gt;&gt; y = df.filter(s)
            &gt;&gt;&gt; plt.stem(np.arange(N),x)
            &gt;&gt;&gt; plt.stem(np.arange(N),y)
            &gt;&gt;&gt; plt.show()

        &quot;&quot;&quot;
        if type(s) is bs.TUsignal:
            x = s.y
        else:
            x = s

        if not causal:
            x = x[::-1]
        y  = si.lfilter(self.b,self.a,x)
        if not causal:
            y = y[::-1]
        if type(s) is bs.TUsignal:
            y = bs.TUsignal(x=s.x,y=y)
        return(y)</div>

<div class="viewcode-block" id="DF.factorize"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.factorize">[docs]</a>    def factorize(self):
        &quot;&quot;&quot; factorize the filter into a minimal phase and maximal phase

        Returns
        -------

        (Fmin,Fmax) : tuple of filter
            Fmin : minimal phase filter
            Fmax : maximal phase filter
        &quot;&quot;&quot;

        if self.fir:
            # selectionne les zeros interne et externe
            internal = np.where(abs(self.z)&lt;1)[0]
            external = np.where(abs(self.z)&gt;=1)[0]
            zi = self.z[internal]
            ze = self.z[external]

            Fmin = DF()
            Fmin.z = zi

            Fmax = DF()
            Fmax.z = ze

            return(Fmin,Fmax)</div>



<div class="viewcode-block" id="DF.wnxcorr"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.wnxcorr">[docs]</a>    def wnxcorr(self,**kwargs):
        &quot;&quot;&quot; filtered noise output autocorrelation

        Parameters
        ---------

        var : float
            input noise variance (default = 1)

        &quot;&quot;&quot;

        defaults = {&#39;var&#39;:1}
        for k in defaults:
            if k not in kwargs:
                kwargs[k] = defaults[&#39;var&#39;]

        HH = self.H.symH(0)
        H2 = HH.y*np.conj(HH.y)
        N  = len(H2)
        tap = np.linspace(-N/2,N/2,N)
        Rn = bs.Usignal(tap,np.real(fft.ifft(H2)))*kwargs[&#39;var&#39;]
        return(Rn)</div>


<div class="viewcode-block" id="DF.freqz"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.freqz">[docs]</a>    def freqz(self,**kwargs):
        &quot;&quot;&quot; freqz :  evaluation of filter transfer function

        The function evaluates an FUsignal

        Parameters
        ----------

        display : boolean
            True
        fsGHz : float
            if set to 0 (relative frequency)

        &quot;&quot;&quot;

        defaults = {&#39;display&#39;:True,
                    &#39;fsGHz&#39;:0}
        for k in defaults:
            if k not in kwargs:
                kwargs[k]=defaults[k]

        (w,h)    = si.freqz(self.b,self.a)

        if kwargs[&#39;fsGHz&#39;]!=0:
            fNGHz = kwargs[&#39;fsGHz&#39;]/2.
            self.H   = bs.FUsignal(w*fNGHz/np.pi,h)
            xlabel = &#39;Frequency (GHz)&#39;
        else:
            self.H   = bs.FUsignal(w/np.pi,h)
            xlabel = &#39;Relative frequency&#39;


        if kwargs[&#39;display&#39;]:
            if &#39;fig&#39; not in kwargs:
                fig = plt.figure()
            else:
                fig = kwargs[&#39;fig&#39;]
            ax1 = fig.add_subplot(211)
            self.H.plot(typ=[&#39;l20&#39;],xlabels=[xlabel],fig=fig,ax=ax1)
            plt.grid()
            ax2 = fig.add_subplot(212)
            self.H.plot(typ=[&#39;d&#39;],xlabels=[xlabel],fig=fig,ax=ax2)
            plt.grid()</div>

        #show()
<div class="viewcode-block" id="DF.butter"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.butter">[docs]</a>    def butter(self,order=5,w=0.25,typ=&#39;low&#39;):
        &quot;&quot;&quot; Butterwoth digital filter design

        Parameters
        ----------

        order : int
            filter order
        w : array_like
            a scalar or length-2 sequence (relative frequency 0&lt;1  fN &lt;=&gt; 1)
        typ : string
            &#39;lowpass&#39; | &#39;highpass&#39; | &#39;bandpass&#39; | &#39;bandstop&#39;

        Examples
        --------

         &gt;&gt;&gt; from pylayers.signal.DF import *
         &gt;&gt;&gt; flt = DF()
         &gt;&gt;&gt; flt.butter(order=3,w=0.25,typ=&#39;low&#39;)
         &gt;&gt;&gt; flt.freqz()

        &quot;&quot;&quot;
        self.order = order
        b,a = si.butter(order,w,typ,analog=False)
        self.b  = b
        self.a  = a</div>

<div class="viewcode-block" id="DF.ellip_bp"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.ellip_bp">[docs]</a>    def ellip_bp(self,wp,ws,gpass=0.5,gstop=20):
        &quot;&quot;&quot; Elliptic Bandpath filter

        Parameters
        ----------

        wp :
        ws :
        gpass
        gstop :

        See Also
        --------

        iirdesign

        &quot;&quot;&quot;
        (b,a)   = si.iirdesign(wp,ws,gpass,gstop,analog=0,ftype=&#39;ellip&#39;,output=&#39;ba&#39;)
        self.b  = b
        self.a  = a</div>

<div class="viewcode-block" id="DF.remez"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.remez">[docs]</a>    def remez(self,numtaps=401,bands=(0,0.1,0.11,0.2,0.21,0.5),desired=(0.0001,1,0.0001)):
        &quot;&quot;&quot; FIR design Remez algorithm

        Parameters
        ----------

        numtaps : int
        bands  : tuple of N floats
        desired : tuple of N/2 floats

        Examples
        --------

        flt.remez(numtaps=401,bands=(0,0.1,0.11,0.2,0.21,0.5),desired=(0.0001,1,0.0001)):

        numtaps = 401
        bands   = (0,0.1,0.11,0.2,0.21,0.5)
        desired = (0.0001,1,0.0001))

        flt.remez( numtaps , bands , desired)

        &quot;&quot;&quot;

        self.a = array([1])
        self.b = remez(numtaps, bands, desired, weight=None, Hz=1, type=&#39;bandpass&#39;, maxiter=25, grid_density=16)</div>

<div class="viewcode-block" id="DF.zplane"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.zplane">[docs]</a>    def zplane(self,title=&#39;&#39;,fontsize=18):
        &quot;&quot;&quot; Display filter in the complex plane

        Parameters
        ----------

        &quot;&quot;&quot;
        rb = self.z
        ra = self.p

        t = np.arange(0,2*np.pi+0.1,0.1)
        plt.plot(np.cos(t),np.sin(t),&#39;k&#39;)
        plt.plot(np.real(ra),np.imag(ra),&#39;o&#39;,color=&#39;r&#39;)
        plt.plot(np.real(rb),np.imag(rb),&#39;o&#39;,color=&#39;g&#39;)
        M1 = -10000
        M2 = -10000
        if len(ra)&gt;0:
            M1 = np.max([np.abs(np.real(ra)),
                    np.abs(np.imag(ra)),
                   ])
        if len(rb)&gt;0:
            M2 = np.max([np.abs(np.real(rb)),
                         np.abs(np.imag(rb)),
                   ])
        M = 1.6*max(1.2,M1,M2)
        plt.axis([-M,M,-0.7*M,0.7*M])
        plt.title(title,fontsize=fontsize)
        plt.show()</div>

<div class="viewcode-block" id="DF.ir"><a class="viewcode-back" href="../../../api/references.html#pylayers.signal.DF.DF.ir">[docs]</a>    def ir(self,N=100,show=False):
        &quot;&quot;&quot; returns impulse response

        Returns
        -------

        ir : np.array
            impulse response

        &quot;&quot;&quot;
        ip    = np.zeros(N)
        ip[0] = 1
        ir    = self.filter(ip)
        if show:
            plt.stem(np.arange(N),ir)
            plt.show()
        ir = bs.TUsignal(x=np.arange(len(ir)) , y = ir)
        return(ir)</div></div>


if __name__ == &quot;__main__&quot;:
#    fe  = 10
#    fN  = fe/2.0
#    wt  = 0.01
#    ws = np.array([3.168,3.696])/fN
#    wp = [ws[0]+wt,ws[1]-wt]
#    flt = DF()
#    gpass = 0.5
#    gstop = 40
#    flt.ellip_bp(wp,ws,gpass,gstop)
#    flt.zplane()
#    flt.freqz()
#    x = np.random.randn(1000)
#    y = flt.filter(x)
#    fo = DF()
#    y2 = fo.filter(x)
#
    f1 = DF()
    f1.b=np.array([1,0])
    f1.a=np.array([1,-0.77])

    ir1 = f1.ir(N=100,show=True)

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, PyLayers developer team.
      Last updated on Feb 01, 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>